---
title: "plotly"
author: "Gunnar"
date: "10/28/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

loading nyc restaurants data

```{r}
library(tidyverse)
library(janitor)
library(p8105.datasets)
library(plotly)
library(lubridate)
```

cleaning the dataset
```{r}
data("rest_inspec")

nyc_rest <- rest_inspec  %>%
  rename(rest_id = camis, rest_name = dba) %>%
  mutate(boro = ifelse(boro == "Missing", NA, boro), boro = as.factor(boro), grade = factor(grade, labels = c("A", "B", "C", "P", "Z", "Not Yet Graded")), cuisine_description = as_factor(cuisine_description)) %>%
  select(boro, grade, score, rest_id, rest_name, cuisine_description, violation_description, violation_code, street, building, zipcode, inspection_date) %>%
  filter(inspection_date >= "2016-11-01") %>%
  drop_na(grade) %>%
  distinct(rest_id, .keep_all = TRUE) %>%
  mutate(address = str_c(building, " ", street, ", New York ", zipcode))
```

##boxplot
```{r}
nyc_rest %>%
  group_by(boro, grade) %>%
  summarize(n_grade = n()) %>%
  mutate(perc_failing = n_grade/sum(n_grade)) %>%
  filter(grade == "A") %>%
  mutate(boro = fct_reorder(boro, perc_failing)) %>%
  plot_ly(y = ~perc_failing, x = ~boro, color = ~boro,
          type = "bar", colors = "viridis")
```


##bar plot of restaurant count by borough
```{r}
nyc_rest %>%
  count(boro) %>%
  mutate(boro = fct_reorder(boro, n)) %>%
  plot_ly(x = ~boro, y = ~n, color = ~boro, 
          type = "bar", colors = "viridis") %>%
  layout(title = "Number of Restaurants by Borough", xaxis = list(title ="Borough"), yaxis = list(title = "Number of Restaurants"))
```











#Dashboard time

